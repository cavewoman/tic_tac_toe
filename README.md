# TicTacToe

This exercise is intended to complement [Programming Elixir 1.3 by Dave Thomas][book].
It accompanies chapter 10 of the book, "Processing Collections - Enum and
Stream".

# Context

You are developing the next massive online video game. You are sure that it is
going to be a blockbuster and make you lots of money. You've chosen Elixir to
ensure that your game servers will be able to handle the vast amount of traffic
generated by future gamers.

Unfortunately, there's a bug in your computer's SSD Trim implementation -- it
has zeroed-out important blocks from your primary storage device. This data loss
has directly impacted your game code, erasing some critical implementation
details! Your backups, offsite backups, and cloud storage copies have all been
destroyed by freak accidents and other suspiciously coincidental acts of nature.

GitHub regrettably reports that they can't seem to find the git objects
referenced by your now-incomplete git tree. Mystified, and understandably
frustrated, you decide to stop pursuing backup recovery and simply re-implement
the components of your game which were erased.

# Game

What game were you making when disaster struck? Tic-tac-toe, of course. We
understand that catastrophic data loss can be traumatizing, so if you need a
refresher you can take a look at these things:

  - [Tic-tac-toe rules on Wikipedia][ttt-wikipedia]
  - [Tic-tac-toe in the browser, courtesy of Google SERP][ttt-google].

# Getting started

1. Fork and clone this repository.

2. Open `lib/tic_tac_toe/game_board.ex` in your editor. Look for the comments
and follow the corresponding exercises (below). The tests should guide you along
the way.

 ```bash
# Run tests
$ mix test --seed 0 --only important
```

3. Make the tests pass.

4. Once you're done, you should have a working game!

 ```bash
# Begin a new game in the terminal
$ mix game.play
```

# Final bits of background information

Your Tic-tac-toe game board is implemented using a struct. This struct has a
field called `spaces` where the game board spaces are stored using an
integer-keyed map.

## Game board example 1

For example, given an empty starter game:

|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|
|---|---|---|
|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|
|&nbsp;&nbsp;|&nbsp;&nbsp;|&nbsp;&nbsp;|

The `spaces` field would look like this:

```elixir
> game_board = TicTacToe.GameBoard.new
> game_board.spaces
%{
  0 => nil, 1 => nil, 2 => nil,
  3 => nil, 4 => nil, 5 => nil,
  6 => nil, 7 => nil, 8 => nil
}
```

## Game board example 2

Another example:

| :o: |     | :x: |
|-----|-----|-----|
|     | :o: | :o: |
| :x: | :x: | :x: |


and the `spaces` field:

```elixir
%{
  0 => :o,  1 => nil, 2 => :x,
  3 => nil, 4 => :o,  5 => :o,
  6 => :x,  7 => :x,  8 => nil
}
```

# Exercise 1

Write a function `chunk_rows/1` that takes game board *spaces* (not a whole
board) and splits the spaces into "rows" consisting of three-tuple lists.

<details>
  <summary>Hint 1</summary>
  Book: "Deal a hand of cards"
</details>

<details>
  <summary>Hint 2</summary>
  [Enum.chunk/2][enum-chunk-2]
</details>

# Exercise 2

Write a function `row_to_str/1` that returns the string representation of a row
(which you generated from ex 1). The format of a row is as follows (using game
board example 2, top row):

```
  +----- Capital letter value if :x or :o. Space otherwise.
  |
  | +--- Vertical bar
  | |
  v v
" O |   | X "
 ^ ^
 | |
 | +--- Space
 +----- Space
```

<details>
  <summary>Hint 1</summary>
  Book: "Create collections whose elements are some function of the original"
</details>

<details>
  <summary>Hint 2</summary>
  Book: "Join a collection"
</details>

<details>
  <summary>Hint 3</summary>
  [Enum.map/2][enum-map-2]
  [Enum.join/2][enum-join-2]
</details>

# Exercise 3

Thinking ahead, you've already enumerated all the possible win conditions for
the game. That is, you know that a winner arises when any column, row, or
diagonal has all three spaces occupied by the same player. You've listed these
in your module as `@win_conditions`.

One possible win condition is when the same player occupies
board spaces 0, 1, and 2.

```elixir
> variant_has_winner?(game_board_example_2, [0, 1, 2])
false
```

Another possibility is when the same player occupies board spaces 6, 7, and 8.

```elixir
> variant_has_winner?(game_board_example_2, [6, 7, 8])
:x
```

Write a function `fetch_win_variants/1` that uses a for loop comprehension to
check the board against all possible `@win_conditions`. This function should
return a list of eight values, one for each win condition.

Game board example 1:

```elixir
> fetch_win_variants(game_board_example_1)
[false, false, false, false, false, false, false, false]
```

Game board example 2:
```elixir
> fetch_win_variants(game_board_example_2)
[false, false, false, false, false, :x, false, false]
```

<details>
  <summary>Hint 1</summary>
  pattern <- enumerable_thing
</details>

<details>
  <summary>Hint 2</summary>
  Use the `variant_has_winner?/2` function in the body of your loop.
</details>

# Exercise 4

Now that you've checked the values for all possible win variants, you'll want to
know if any of them are actually winners or not! Write a function `check_win/1`
that takes a game board, computes the variants (via `fetch_win_variants/1`), and
squashes the elements of that list into a single result.

For example, remember that with game board 2:
```elixir
> fetch_win_variants(game_board_example_2)
[false, false, false, false, false, :x, false, false]
```
In this instance, you'll want to have your `check_win/1` do this:
```elixir
> check_win(game_board_example_2)
:x
```

If nobody has won yet, just return `false`.

<details>
  <summary>Hint 1</summary>
  Book: "Fold elements into a single value"
</details>

<details>
  <summary>Hint 2</summary>
  [Enum.reduce/2][enum-reduce-2]
</details>


[book]: https://pragprog.com/book/elixir13/programming-elixir-1-3
[enum-chunk-2]: https://hexdocs.pm/elixir/Enum.html#chunk/2
[enum-join-2]: https://hexdocs.pm/elixir/Enum.html#join/2
[enum-map-2]: https://hexdocs.pm/elixir/Enum.html#map/2
[enum-reduce-2]: https://hexdocs.pm/elixir/Enum.html#reduce/2
[ttt-wikipedia]: https://en.wikipedia.org/wiki/Tic-tac-toe
[ttt-google]: https://www.google.com/search?q=tic+tac+toe
